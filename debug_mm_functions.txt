
--- function Nx.Map:MUE() ---
function Nx.Map:MUE() if not self.MMO1 then return end local mm=self.MMF local mmf=self.LOp.NXMMFull if self.Win1:ISM() and self.GOp["MapMMHideOnMax"] or self.MMFS<.02 then mm:SetPoint("TOPLEFT",1,0) mm:SetScale(.02) mm:SetFrameLevel(1) for n,f in ipairs(self.MMM) do f:SetScale(.001) end return end if self.MMZT==0 then self:MUM("MapMMDockSquare") local icS1=self.GOp["MapMMDockIScale"] self:MSS(self.MMFS,icS1) local x=0 local y=0 local sz=140*self.MMFS if self.GOp["MapMMDockRight"] then x=(self.MaW-sz+1) end if self.GOp["MapMMDockBottom"] then y=(self.MaH-sz+1) end mm:ClearAllPoints() mm:SetPoint("TOPLEFT",(x+self.GOp["MapMMDXO"])/icS1,(-y-self.GOp["MapMMDYO"])/icS1) mm:Show() mm:SetFrameLevel(self.Lev) self:MUDF(self.Lev+1) self.Lev=self.Lev+2 end if self.MMZC then self.MMZC=false local zoo=max(self.MMZT-1,0) if self.MMZT==0 then zoo=self.GOp["MapMMDockZoom"] end local z=zoo-1 if z<0 then z=1 end mm:SetZoom(z) mm:SetZoom(zoo) if self.MMZT==0 then mm:SetAlpha(1) end end MinimapPing:SetScale(self.Win1.Frm:GetScale()*mm:GetScale()) end 

--- function Nx.Map:MiU() ---
function Nx.Map:MiU() if not self.MMO1 then self:MDF1() return end if self.GOp["MapMMMoveCapBars"] then local y=0 for n=1,NUM_EXTENDED_UI_FRAMES do local f=getglobal("WorldStateCaptureBar" .. n) if f and f:IsShown() then f:SetPoint("TOPRIGHT",self.Win1.Frm,"BOTTOMRIGHT",0,y) y=y+f:GetHeight() end end end if self.DeS then self.MMS1=0 local sc=self.DeS for n=1,6 do self.MMS[n]=(8-n)*66.6666666666666/sc end end local mm=self.MMF local lOp=self.LOp local sca1=self.MMS local inf=self.MWI[self.RMI] if inf.Cit and not inf.MMO then sca1=self.MMSC end local zoT1=0 local zoo=mm:GetZoom(1) local doc=lOp.NXMMFull or self.GOp["MapMMDockAlways"] if self.Win1:ISM() and self.GOp["MapMMDockOnMax"] then doc=true end if not doc and not self.InI and self.ScD>lOp.NXMMDockOnAtScale then mm:ClearAllPoints() for n=1,6 do local sz=sca1[n] if self:CMMW(mm,self.PlX,self.PlY,sz,sz) then zoT1=n break end end end local al=lOp.NXMMAlpha local ind1=IsIndoors() local inC=self.Ind1~=ind1 self.Ind1=ind1 if self.InI then al=1 else if ind1 and self.GOp["MapMMDockIndoors"] then zoT1=0 end if inC and self.GOp["MapMMIndoorTogFullSize"] then lOp.NXMMFull=false if not inf.Cit and ind1 then lOp.NXMMFull=true end self.MMMIF:SetChecked(lOp.NXMMFull) Nx.Men:ChU(self.MMMIF) end if zoT1==0 then al=lOp.NXMMDockAlpha end if IsAltKeyDown() then al=1 self.MMZC=true end end if self.MMZT~=zoT1 or zoT1>0 and self.MMS1~=self.ScD or inC then self.MMZT=zoT1 self.MMS1=self.ScD self.MMZC=true if self.MMAD==0 then self.MMAD=2 end end if self.MMAD>0 then self.MMAD=self.MMAD-1 self.MMZC=true end mm:SetAlpha(al) self:MDF1() if zoT1>0 then self:MUM("MapMMSquare") local abo=IsControlKeyDown() if self.GOp["MapMMAboveIcons"] then abo=not abo end local lvl=self.Lev if abo then lvl=lvl+15 end mm:SetFrameLevel(lvl) self:MUDF(lvl+1) self.Lev=self.Lev+2 else local sc=self.MMFS self.MMFS=Nx.IBG and lOp.NXMMDockScaleBG or lOp.NXMMDockScale if lOp.NXMMFull then self.MMFS=min(self.MaW,self.MaH)/140 end end end 
